<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!---<link href="index1.html" id="hoten">--->
    <title>The Vitamin Shoppe</title>
    <link rel="stylesheet" href="styleanimation.css">
</head>
<body>
    <form id="animation">
    <div class="logo">
        <img width="450" height="85" src="image/logo.jpg">
    </div>
    <div class="center">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!---<div class="input">
        <input type="text" id ="hoten" name="hoten" required>
        <input type="submit" name="submit" value="Login" id="sub">
    </div>--->
    <div class="tong">
    <div class="content">
        <input type="submit" name="submit" value="Login" id="sub" >
        <p1>Xin chào anh/chị <strong>Hovaten</strong> với các dữ liệu anh chị cung cấp, hệ thống AI của The Vitamin Shoppe xây dựng chế độ ăn dinh dưỡng phù hợp với bệnh benhcuakhach như sau:<br><br></p1>
    </div>
    <div class="site-main">
            <!---<div id="outputx"></div>--->      
            <img width="250" height="50" src="image/monday1.png"><br>
            <div id="output monday"><br></div>
            <img width="250" height="50" src="image/tuesday1.png"><br>
            <div id="output tuesday"><br></div>
            <img width="250" height="50" src="image/wednesday1.png"><br>
            <div id="output wednesday"><br></div>
            <img width="250" height="50" src="image/thurday1.png"><br>
            <div id="output thursday"><br></div>
            <img width="250" height="50" src="image/friday 1.png"><br>
            <div id="output friday"><br></div>
            <img width="250" height="50" src="image/saturday (1).png"><br>
            <div id="output saturday"><br></div>
            <img width="250" height="50" src="image/sunday1.png"><br>
            <div id="output sunday"><br></div>
            <div id="output xxx"><br></div>
            <div id="loading" style="display:none"></div>
            <br>
        </p>
    </div>
    <div class="content-area1">
        <ph4>
            <h3>Thực phẩm khuyến cáo dành cho bệnh benhcuakhach</h4>
        </ph4>
        <p>
            <div id="output1"><br></div>
            <div id="loading1" style="display:none"></div>
        </p>
        <p>
            <div id="output2"><br></div>
            <div id="loading2" style="display:none"></div>
        </p>
    <div class="content-area2">
        <p3>
        Để áp dụng chế độ dinh dưỡng cùng các biện pháp hiệu quả cho bệnh benhcuakhach sẽ có sự trợ giúp của các bạn TLSKCN tại The Vitamin Shoppe 
        </p3>    
    </div>
</form>
    <!---<a button="quay lại" href="index1.html">quay lại</a>--->
    
    </div>
    <script>
        const hotenValue = sessionStorage.getItem('hotenValue');
        const benhValue = sessionStorage.getItem('benhValue');
        
        const p1 = document.querySelector('p1');
        const oldText = p1.innerHTML;
        const newText = oldText.replace('Hovaten', hotenValue);
        const newText1 = newText.replace('benhcuakhach', benhValue);
        p1.innerHTML = newText1;
       
        const p3 = document.querySelector('p3');
        const oldText3 = p3.innerHTML;
        const newText3 = oldText3.replace('benhcuakhach', benhValue);
        p3.innerHTML = newText3;
        
        const ph4 = document.querySelector('ph4');
        const oldText4 = ph4.innerHTML;
        const newText4 = oldText4.replace('benhcuakhach', benhValue);
        ph4.innerHTML = newText4;
        
        const p2 = document.querySelector('p2');
        
// request
        const prompt = "Xây dựng thực đơn dinh dưỡng cụ thể ba bữa trong vòng 7 ngày cho người bị bệnh " + benhValue ;
        const prompt1="Thực phẩm chức năng cho bệnh " + benhValue;
        const prompt2 = "Lời khuyên của chuyên gia về chế độ sinh hoạt tập luyện cho bệnh " + benhValue;
        const maxTokens = 2048;
        //const maxTokens = 4000;
        const engine = "text-davinci-003";
        //const engine ="code-davinci-002";
        // api key
        const apiKey = "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";
        // câu hỏi về 7 ngày

        //const outputDiv = document.getElementById("output");
        //const outputDivx = document.getElementById("outputx");
        //outputDivx.innerHTML = prompt;
        const outputDivt1 = document.getElementById("output monday");
        const outputDivt2 = document.getElementById("output tuesday");
        const outputDivt3 = document.getElementById("output wednesday");
        const outputDivt4 = document.getElementById("output thursday");
        const outputDivt5 = document.getElementById("output friday");
        const outputDivt6 = document.getElementById("output saturday");
        const outputDivt7 = document.getElementById("output sunday");
        const outputDivt8 = document.getElementById("output xxx");
        // 2 câu hỏi sau
        const outputDiv1 = document.getElementById("output1");
        const outputDiv2 = document.getElementById("output2")
        const loadingDiv = document.getElementById("loading");
        const loadingDiv1 = document.getElementById("loading1");
        const loadingDiv2 = document.getElementById("loading2");
        
        const promt1 = document.getElementById("prompt")
        
        loadingDiv.style.display = "block";
        
        
        let form = document.querySelector("form");
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    loadingDiv.innerHTML = "<p>Đang tải phản hồi...</p>"
                    axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
                    prompt: prompt,
                    max_tokens: maxTokens,
                    temperature: 0.7,
                    n: 1,
                    stop: null,
                    }, {
                    headers: { Authorization: `Bearer ${apiKey}` }
                    })
                    .then((response) => {
                        const answer = response.data.choices[0].text;
                        //const list = answer.spit(/\n\n/g);
                        const answerx = answer.replace(/\n\n/g,"//" ).replace(/\n/g,"//");                
                        const list = answerx.split("//");
                        outputDivt1.innerHTML =  list[2] + "<br>" + list[3] + "<br>" + list[4] + "<br>";
                        outputDivt2.innerHTML =  list[6] + "<br>" + list[7] + "<br>" + list[8] + "<br>";
                        outputDivt3.innerHTML =  list[10] + "<br>" + list[11] + "<br>" + list[12] + "<br>";
                        outputDivt4.innerHTML =  list[14] + "<br>" + list[15] + "<br>" + list[16] + "<br>";
                        outputDivt5.innerHTML =  list[18] + "<br>" + list[19] + "<br>" + list[20] + "<br>";
                        outputDivt6.innerHTML =  list[22] + "<br>" + list[23]+ "<br>" + list[24] + "<br>";
                        outputDivt7.innerHTML =  list[26] + "<br>" + list[27]+ "<br>" + list[28] + "<br>";
                
                        loadingDiv.style.display = "none";
                    })
        //prompt1
                axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
                    prompt: prompt1,
                    max_tokens: maxTokens,
                    temperature: 0.7,
                    n: 1,
                    stop: null,
                    }
                , {
                    headers: { Authorization: `Bearer ${apiKey}` }
                    })
                    .then((response) => {
                        const answer1 = response.data.choices[0].text;
                        outputDiv1.innerHTML = "<p>" + answer1.replace(/\n/g,"<br>") + "</p>";
                        loadingDiv1.style.display = "none";
                    })
           //prompt2 
                axios.post('https://api.openai.com/v1/engines/'+ engine + '/completions', {
                    prompt: prompt2,
                    max_tokens: maxTokens,
                    temperature: 0.7,
                    n: 1,
                    stop: null,
                    }, {
                    headers: { Authorization: `Bearer ${apiKey}` }
                    })
                    .then((response) => {
                        const answer3 = response.data.choices[0].text;
                        const answer4 = answer3
                    outputDiv2.innerHTML = "<h3> Lời khuyên của tôi </h3>" + answer3.replace(/\n/g,"<br>") + "</p>";
                    loadingDiv2.style.display = "none";
                })
                    .catch((error) => {
                    console.log(error);
                    loadingDiv.style.display = "none";
                });
                    document.querySelector("#sub").value = "Submit"
                })
        //prompt
        
    </script>
</body>
</html>